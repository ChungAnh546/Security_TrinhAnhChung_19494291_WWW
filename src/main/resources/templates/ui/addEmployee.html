<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Add Employee</title>

  <!-- Google Font: Source Sans Pro -->
  <link rel="stylesheet"
    th:href="@{https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback}">
  <!-- Font Awesome -->
  <link rel="stylesheet" th:href="@{https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css}"
    integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" th:href="@{/plugins/fontawesome-free/css/all.min.css}">
  <!-- Theme style -->
  <link rel="stylesheet" th:href="@{/dist/css/adminlte.min.css}">

</head>

<body class="hold-transition sidebar-mini">

  <div class="wrapper">
    <!-- Navbar -->

    <nav class="main-header navbar navbar-expand navbar-white navbar-light">
      <!-- Left navbar links -->

      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" data-widget="pushmenu" th:href="@{#}" role="button"><i class="fas fa-bars"></i></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" data-widget="fullscreen" th:href="@{#}" role="button">
            <i class="fas fa-expand-arrows-alt"></i>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" data-widget="control-sidebar" data-slide="true" th:href="@{#}" role="button">
            <i class="fas fa-th-large"></i>
          </a>
        </li>
      </ul>



      <!-- Right navbar links -->
      <ul class="navbar-nav ml-auto">
        <!-- Navbar Search -->


        <!-- Messages Dropdown Menu -->
        <!--  -->
        <!-- Notifications Dropdown Menu -->


      </ul>
      <div class="user-panel mr-2 d-flex">
        <div class="image">
          <img th:src="@{/public/tom.jpg}" id="accImage" width="50" height="50" class="img-circle elevation-2"
            alt="User Image">
        </div>
        <div class="info">
          <a th:href="@{#}" id="accName" class="d-block"></a>
        </div>
      </div>
    </nav>
    <!-- /.navbar -->

    <!-- Main Sidebar Container -->
    <aside class="main-sidebar sidebar-dark-primary elevation-4">
      <!-- Brand Logo -->


      <!-- Sidebar -->
      <div class="sidebar">
        <!-- Sidebar user (optional) -->




        <!-- Sidebar Menu -->
        <nav class="mt-2">
          <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
            <!-- Add icons to the links using the .nav-icon class
               with font-awesome or any other icon font library -->

            <li class="nav-item menu-open">
              <a th:href="@{#}" class="nav-link active">
                <i class="nav-icon fas fa-edit"></i>
                <p>
                  Manager
                  <i class="fas fa-angle-left right"></i>
                </p>
              </a>
              <ul class="nav nav-treeview">
                <li class="nav-item">
                  <a th:href="@{/employee/add}" class="nav-link active">
                    <i class="far fa-circle nav-icon"></i>
                    <p>Add Employee</p>
                  </a>
                </li>
                <li class="nav-item">
                  <a th:href="@{/employee/list}" class="nav-link">
                    <i class="far fa-circle nav-icon"></i>
                    <p>List Employee</p>
                  </a>
                </li>
                <li class="nav-item">
                  <a th:href="@{/customer/add}" class="nav-link">
                    <i class="far fa-circle nav-icon"></i>
                    <p>Add Customer</p>
                  </a>
                </li>
                <li class="nav-item">
                  <a th:href="@{/customer/list}" class="nav-link ">
                    <i class="far fa-circle nav-icon"></i>
                    <p>List Customer</p>
                  </a>
                </li>
              </ul>
            </li>


          </ul>
        </nav>
        <!-- /.sidebar-menu -->
      </div>
      <!-- /.sidebar -->
    </aside>

    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper">
      <!-- Content Header (Page header) -->


      <!-- Main content -->
      <section class="content">
        <div class="container-fluid">
          <div class="row">
            <!-- left column -->
            <div class="col-md-12">
              <!-- jquery validation -->
              <div class="card card-primary">
                <div class="card-header">
                  <h3 class="card-title">Add Employee</h3>
                </div>
                <!-- /.card-header -->
                <!-- form start -->
                <form id="quickForm">
                  <div class="card-body row">
                    <div class="col-sm-7 ">
                      <div class="form-group row" style="position: relative;">
                        <label for="InputFullName" class="col-sm-2 col-form-label">Full name</label>
                        <div class="col-sm-10 input">
                          <input type="text" name="fullName" class="form-control" id="inputFullName"
                            placeholder="Enter full name">
                        </div>
                        <p style="color: red;left: 100%;position: absolute;">*</p>
                      </div>
                      <div class="form-group row">
                        <label for="InputPhone" class="col-sm-2 col-form-label">Phone</label>
                        <div class="col-sm-10 input">
                          <input type="number" name="phone" class="form-control" id="inputPhone"
                            placeholder="Enter phone">
                        </div>
                        <p style="color: red;left: 100%;position: absolute;">*</p>
                      </div>

                      <div class="form-group row">
                        <label for="exampleInputEmail1" class="col-sm-2 col-form-label">Email</label>
                        <div class="col-sm-10 input">
                          <input type="email" name="email" class="form-control" id="inputEmail"
                            placeholder="Enter email">
                        </div>
                        <p style="color: red;left: 100%;position: absolute;">*</p>
                      </div>
                      <div class="form-group row">
                        <label for="InputAddress" class="col-sm-2 col-form-label">Address</label>
                        <div class="col-sm-10 input">
                          <input type="text" name="address" class="form-control" id="inputAddress"
                            placeholder="Enter address">
                        </div>
                        <p style="color: red;left: 100%;position: absolute;">*</p>
                      </div>
                      <div class="form-group row">
                        <label for="InputUserName" class="col-sm-2 col-form-label">User Name</label>
                        <div class="col-sm-10 input">
                          <input type="text" name="userName" class="form-control" id="inputUserName"
                            placeholder="Enter user name">
                        </div>
                        <p style="color: red;left: 100%;position: absolute;">*</p>
                      </div>

                      <div class="form-group row">
                        <label for="exampleInputPassword1" class="col-sm-2 col-form-label">Password</label>
                        <div class="col-sm-10 input">
                          <input type="password" name="password" class="form-control" id="inputPassword"
                            placeholder="Password">
                        </div>
                        <p style="color: red;left: 100%;position: absolute;">*</p>
                      </div>
                      <div class="form-group row">
                        <label for="inputConfirmPassword1" class="col-sm-2 col-form-label">Confirm password</label>
                        <div class="col-sm-10 input">
                          <input type="password" name="confirmPassword" class="form-control" id="inputConfirmPassword1"
                            placeholder="Cofirm Password">

                        </div>
                        <p style="color: red;left: 100%;position: absolute;">*</p>
                      </div>
                      <div class="form-group row">
                        <label for="exampleSelectRounded0" class="col-sm-2 col-form-label">Role </label>
                        <div class="col-sm-10 ">
                          <select class=" form-control" id="role">
                            <option>Employee</option>
                            <option>Admin</option>

                          </select>
                        </div>
                      </div>
                      <div class="form-group row" hidden>
                        <label for="image" class="col-sm-2 col-form-label">hình </label>
                        <div class="col-sm-10 ">
                          <input type="file" id="inputImage" accept="image/*" onchange="handleImageSelect(event)">
                        </div>
                      </div>
                    </div>
                    <div class="col-sm-5">
                      <div class="d-flex justify-content-center mt-5">
                        <div class="d-flex flex-column">
                          <label style="text-align: center;">
                            Staff image</label>
                          <div class="image " id="divImage">
                            <img th:src="@{/public/tom.jpg}" id="imgEmployee" width="200" height="200"
                              style=" border-radius: 50%;object-fit: cover;text-align: center;" alt="User Avatar"
                              class="img-size-350  img-circle elevation-2">


                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!-- /.card-body -->
                  <div class="card-footer d-flex justify-content-center ">
                    <button type="submit" hidden></button>
                    <button id="btnSave" class="btn btn-success"><i class="fa-regular fa-floppy-disk"></i>
                      Save</button>
                    <button type="cancel" class="btn btn-info ml-5" id="btnCancel"><i
                        class="fa-solid fa-rotate-right"></i> Cancel</button>
                    <!-- <button type="submit" hidden></button> -->
                  </div>
                </form>
              </div>
              <!-- /.card -->
            </div>
            <!--/.col (left) -->
            <!-- right column -->

            <!--/.col (right) -->
          </div>
          <!-- /.row -->
        </div><!-- /.container-fluid -->
      </section>
      <!-- /.content -->
    </div>
    <!-- /.content-wrapper -->


    <!-- Control Sidebar -->
    <aside class="control-sidebar control-sidebar-dark">
      <!-- Control sidebar content goes here -->
    </aside>
    <!-- /.control-sidebar -->
  </div>
  <!-- ./wrapper -->

  <!-- jQuery -->
  <script th:src="@{/plugins/jquery/jquery.min.js}"></script>
  <script th:src="@{https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js}"></script>

  <!-- Bootstrap 4 -->
  <script th:src="@{https://cdn.jsdelivr.net/npm/sweetalert2@11}"></script>
  <script th:src="@{/plugins/bootstrap/js/bootstrap.bundle.min.js}"></script>
  <!-- jquery-validation -->
  <script th:src="@{/plugins/jquery-validation/jquery.validate.min.js}"></script>
  <script th:src="@{/plugins/jquery-validation/additional-methods.min.js}"></script>
  <!-- AdminLTE App -->
  <script th:src="@{/dist/js/adminlte.min.js}"></script>
  <!-- AdminLTE for demo purposes -->
  <script th:src="@{/dist/js/demo.js}"></script>
  <!-- Page specific script -->
  <script>
    async function createEmployee(data) {
      var url = "/employee/create";
      try {
        await $.ajax({
          url: url,
          type: "POST",
          contentType: "application/json",
          data: JSON.stringify(data),
          success: function (response) {
            return true;
          },
          error: function (xhr) {
            return false;
          }
        });
        return true;
      } catch (error) {
        return false;
      }

    }
    function waitCreate() {
      let timerInterval
      Swal.fire({
        title: 'Wait for more staff!',
        html: 'Wait <b></b> milliseconds.',
        timer: 5000,
        timerProgressBar: true,
        didOpen: () => {
          Swal.showLoading()
          const b = Swal.getHtmlContainer().querySelector('b')
          timerInterval = setInterval(() => {
            b.textContent = Swal.getTimerLeft()
          }, 100)
        },
        willClose: () => {
          clearInterval(timerInterval)
        }
      }).then((result) => {
        /* Read more about handling dismissals below */
        if (result.dismiss === Swal.DismissReason.timer) {
          console.log('I was closed by the timer')
        }
      })
    }
    async function getImageData(imageUrl) {
      // Gửi yêu cầu AJAX để lấy dữ liệu của hình ảnh
      var data = await $.ajax({
        url: "https://api.dropboxapi.com/2/files/get_temporary_link",
        type: "POST",
        headers: {
          "Authorization": "Bearer Bearer sl.Bh4WNI82LjiJ0LCss3wvVYHGXf0MbkrkFRdtgutigAsV9-IvIeilTzGfCXcRV_p0WEZDnpoJyQMX3BByjeeJBd81PbCzbiofrZJSNa3DcNVoWcV-LS42WNgs2uF6SN6BI7JLxTUe2W4a",
          "Content-Type": "application/json"
        },
        data: JSON.stringify({
          path: imageUrl
        }),
        success: function (response) {
          // Lấy URL tải xuống ảnh từ phản hồi
          // var downloadUrl = response.link;

          // // Sử dụng URL để hiển thị ảnh trong thẻ img
          // $('#uploadedImage').attr('src', downloadUrl);
        },
        error: function (error) {
          console.error('Error:', error);
        }
      });
      return data.link;
    }
    async function updateImageToDropBox() {
      // Lấy tệp hình ảnh được chọn
      var imageFile = $('#inputImage')[0].files[0];

      // Kiểm tra xem đã chọn hình ảnh hay chưa
      if (imageFile) {
        // Tạo đối tượng FormData để chứa tệp hình ảnh
        // var newFileName = imageFile.name.replace(/\.[^/.]+$/, ".jpg");

        // // Tạo đối tượng FormData để chứa tệp hình ảnh với tên mới
        // var formData = new FormData();
        // formData.append('file', imageFile, newFileName);
        // console.log(formData);
        // Gửi yêu cầu tải lên bằng AJAX
        var data = await $.ajax({
          url: 'https://content.dropboxapi.com/2/files/upload',
          type: 'POST',
          headers: {
            'Authorization': 'Bearer Bearer sl.Bh4WNI82LjiJ0LCss3wvVYHGXf0MbkrkFRdtgutigAsV9-IvIeilTzGfCXcRV_p0WEZDnpoJyQMX3BByjeeJBd81PbCzbiofrZJSNa3DcNVoWcV-LS42WNgs2uF6SN6BI7JLxTUe2W4a',
            'Content-Type': 'application/octet-stream',
            'Dropbox-API-Arg': JSON.stringify({
              'path': '/image.jpg',
              'mode': 'add',
              'autorename': true,
              'mute': false
            })
          },
          data: imageFile,
          processData: false,
          contentType: false,
          success: function (data) {

            // var imageUrl = data.path_display;

            // getImageData(imageUrl);
            // var downloadUrl = "https://www.dropbox.com/s/dl" + imageUrl.replace(/ /g, "%20");
            // console.log('Uploaded image:', downloadUrl);
            // $('#uploadedImage').attr('src', downloadUrl);
          },
          error: function (error) {
            console.error('Upload error:', error);
          }
        });
      } else {
        alert('Vui lòng chọn một hình ảnh.');
      }
      return data.path_display;
    }

    async function getEmployeeByEmail(email) {
      var employee;
      try {
        employee = await $.ajax({
          type: "GET",
          url: "/employee/search/email?email=" + email,
          dataType: "json",
          success: function (response) {

          },
          error: function (jqXHR, textStatus, errorThrown) {
            return null
          }
        });
      } catch (error) {
        employee = null;
      }
      return employee;

    }
    async function getEmployeeByPhone(phone) {
      var employee;
      try {
        employee = await $.ajax({
          type: "GET",
          url: "/employee/search/phone?phone=" + phone,
          dataType: "json",
          success: function (response) {

          },
          error: function (jqXHR, textStatus, errorThrown) {
            return null
          }
        });
      } catch (error) {
        employee = null;
      }
      return employee;

    }
    async function getEmployeeByUserName(userName) {
      var employee;
      try {
        employee = await $.ajax({
          type: "GET",
          url: "/employee/search/user-name?userName=" + userName,
          dataType: "json",
          success: function (response) {

          },
          error: function (jqXHR, textStatus, errorThrown) {
            return null
          }
        });
      } catch (error) {
        employee = null;
      }
      return employee;

    }
    $("#inputEmail").change(async function () {
      var email = await getEmployeeByEmail($("#inputEmail").val());
      if (email) {
        var validator = $("#quickForm").validate();
        validator.showErrors({
          email: "Email already exists." // Thông báo lỗi trùng email
        });
      }
    })
    $("#inputPhone").change(async function () {
      var phone = await getEmployeeByPhone($("#inputPhone").val());
      if (phone) {
        var validator = $("#quickForm").validate();
        validator.showErrors({
          phone: "Phone already exists." // Thông báo lỗi trùng email
        });
      }
    })
    $("#inputUserName").change(async function () {

      var userName = await getEmployeeByUserName($("#inputUserName").val());
      console.log(userName)
      if (userName) {
        var validator = $("#quickForm").validate();
        validator.showErrors({
          userName: "User Name already exists." // Thông báo lỗi trùng email
        });
      }
    })
    async function duplicateCheck(email, phone, userName) {
      var phoneRegex = /^\d{10}$/;
      var emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!phoneRegex.test(phone)) {
        var validator = $("#quickForm").validate();
        validator.showErrors({
          phone: "Phone already exists." // Thông báo lỗi trùng email
        });
        return false;
      }
      if (!emailRegex.test(email)) {
        var validator = $("#quickForm").validate();
        validator.showErrors({
          email: "Email already exists." // Thông báo lỗi trùng email
        });
        return false;
      }
      var emailCheck = await getEmployeeByEmail(email);

      var phoneCheck = await getEmployeeByPhone(phone);

      var userNameCheck = await getEmployeeByUserName(userName);
      if (emailCheck) {
        var validator = $("#quickForm").validate();
        validator.showErrors({
          email: "Email already exists." // Thông báo lỗi trùng email
        });
      }
      if (phoneCheck) {
        var validator = $("#quickForm").validate();
        validator.showErrors({
          phone: "Phone already exists." // Thông báo lỗi trùng email
        });
      }
      if (userNameCheck) {
        var validator = $("#quickForm").validate();
        validator.showErrors({
          userName: "User Name already exists." // Thông báo lỗi trùng email
        });
      }

      if (emailCheck || phoneCheck || userNameCheck) {
        return false;
      } else {
        return true;
      }

    }
    function createObjectEmployee(fullName, phone, email, address, userName, password, role, avatar) {
      var object = {
        full_name: fullName,
        phone: phone,
        email: email,
        address: address,
        user_name: userName,
        pass: password,
        status: "active",
        role: role === "Employee" ? 0 : 1,
        avatar: avatar
      }
      return object;
    }
    // $("#btnSave").on("click", async function () {
    //   try {
    //     // alert("Form successful submitted!");
    //     var fullName = $("#inputFullName").val();
    //     var phone = $("#inputPhone").val();
    //     var email = $("#inputEmail").val();
    //     var address = $("#inputAddress").val();
    //     var userName = $("#inputUserName").val();
    //     var password = $("#inputPassword").val();
    //     var role = $("#role").val();
    //     var checkInput = await duplicateCheck(email, phone, userName)
    //     // var object = createObjectEmployee(fullName, phone, email, address, userName, password, role, null);
    //     // var stateCreateEmployee = await createEmployee(object);
    //     // setTimeout(function () {
    //     //   if (stateCreateEmployee) {
    //     //     alert("tao thanh cong");
    //     //   } else {
    //     //     alert("tao that bai");
    //     //   }
    //     // }, 1000);
    //     if (checkInput) {
    //       alert("input ok")
    //     } else {
    //       alert("input ko hopwj le")
    //     }
    //   } catch (error) {
    //     alert(error)
    //   }
    // })
    $(function () {
      var savedData = localStorage.getItem('acc');
      if (savedData) {
        // Parse the data from string to its original format
        var parsedData = JSON.parse(savedData);
        //console.log(parsedData.image)
        $('#accImage').attr('src', parsedData.avatar);
        $("#accName").text(parsedData.full_name);
        // Use the retrieved data as needed

      } else {
        // Handle the case when no data is found in localStorage
        alert('Error');
      }
      // $.validator.setDefaults({
      //   submitHandler: async function (event) {
      //     try {
      //       event.preventDefault();
      //       // alert("Form successful submitted!");
      //       var fullName = $("#inputFullName").val();
      //       var phone = $("#inputPhone").val();
      //       var email = $("#inputEmail").val();
      //       var address = $("#inputAddress").val();
      //       var userName = $("#inputUserName").val();
      //       var password = $("#inputPassword").val();
      //       var role = $("#role").val();
      //       var checkInput = await duplicateCheck(email, phone, userName)
      //       // var object = createObjectEmployee(fullName, phone, email, address, userName, password, role, null);
      //       // var stateCreateEmployee = await createEmployee(object);
      //       // setTimeout(function () {
      //       //   if (stateCreateEmployee) {
      //       //     alert("tao thanh cong");
      //       //   } else {
      //       //     alert("tao that bai");
      //       //   }
      //       // }, 1000);
      //       if (checkInput) {
      //         alert("input ok")
      //       } else {
      //         alert("input ko hopwj le")
      //       }
      //     } catch (error) {
      //       alert(error)
      //     }


      //   }
      // });

      $('#btnSave').on('click', function () {
        var $button = $(this);

        if (!$button.hasClass('disabled')) {
          $button.addClass('disabled');
          $('#quickForm').submit();
          // Thực hiện các hành động khi button được click

          setTimeout(function () {
            $button.removeClass('disabled');
          }, 1000); // Thời gian đợi trước khi enable lại button (ở đây là 1 giây)
        }
      });
      $('#btnSave').on('dblclick', function () {

      });
      var isSubmitting = false;
      $('#quickForm').submit(async function (event) {
        event.preventDefault();
        if (!isSubmitting) {
          isSubmitting = true;

          try {

            // alert("Form successful submitted!");
            //lay gia tri
            var fullName = $("#inputFullName").val();
            var phone = $("#inputPhone").val();
            var email = $("#inputEmail").val();
            var address = $("#inputAddress").val();
            var userName = $("#inputUserName").val();
            var password = $("#inputPassword").val();
            var confirmPassword = $("#inputConfirmPassword1").val();

            var role = $("#role").val();
            //kiem tra co anh ko
            var imageFile = $('#inputImage')[0].files[0];
            var linkImage = null;
            // Kiểm tra xem đã chọn hình ảnh hay chưa


            //kt trung
            var checkInput = false;
            checkInput = await duplicateCheck(email, phone, userName)
            //  console.log($('#quickForm').validate());
            if (checkInput && fullName && phone && email && address && userName && password && (password === confirmPassword)) {
              //tao employee
              waitCreate()
              if (imageFile) {
                var path_display = await updateImageToDropBox();
                // co tao link
                linkImage = await getImageData(path_display);
              }

              var object = createObjectEmployee(fullName, phone, email, address, userName, password, role, linkImage);
              var stateCreateEmployee = await createEmployee(object);
              if (stateCreateEmployee) {

                Swal.fire(
                  {

                    icon: 'success',
                    title: 'Success',
                    showConfirmButton: false,
                    timer: 1500
                  })
                setTimeout(function () {
                  window.location.href = "/employee/list";
                }, 1600);
              } else {
                Swal.fire({
                  icon: 'error',
                  title: 'Add employee fail',
                  text: 'Add employee fail.',

                })
              }

              //tieeps tucj submit
              // $(this).unbind("submit").submit();
            } else {
              //ko tao employee
            }
          } catch (error) {
            alert(error)
          }
        }
      })
      $('#quickForm').validate({
        rules: {
          email: {
            required: true,
            email: true,
          },
          password: {
            required: true,
            minlength: 6,

          },
          fullName: {
            required: true,

          },
          phone: {
            required: true,
            minlength: 10,
            maxlength: 10
          },
          address: {
            required: true,

          },
          userName: {
            required: true,
            minlength: 8
          },
          confirmPassword: {
            required: true,
            equalTo: "#inputPassword"
          },
        },
        messages: {
          email: {
            required: "Please enter a email address",
            email: "Please enter a valid email address"
          },
          fullName: {
            required: "Please enter full name",

          },
          phone: {
            required: "Please enter a phone",
            minlength: "Please enter a valid phone",
            maxlength: "Please enter a valid phone"
          },
          address: {
            required: "Please enter a address",

          },
          userName: {
            required: "Please enter a userName",
            minlength: "Your user name must be at least 8 characters long"
          },
          confirmPassword: {
            equalTo: "Confirm password is incorrect",
            required: "Please provide a password",

          },
          password: {

            required: "Please provide a password",
            minlength: "Your password must be at least 6 characters long"
          },

        },
        errorElement: 'span',
        errorPlacement: function (error, element) {
          error.addClass('invalid-feedback');
          element.closest('.input').append(error);
        },
        highlight: function (element, errorClass, validClass) {
          $(element).addClass('is-invalid');
        },
        unhighlight: function (element, errorClass, validClass) {
          $(element).removeClass('is-invalid');
        }
      });
    });
    $("#btnCancel").on("click", function () {
      $("#quickForm").resetForm();
    })
    $("#divImage").on("click", function () {
      $("#inputImage").click();
    })
    function handleImageSelect(event) {
      var imageFile = event.target.files[0];

      // Kiểm tra xem đã chọn hình ảnh hay chưa
      if (imageFile) {
        var reader = new FileReader();

        // Đọc tệp ảnh và gán vào thuộc tính src của thẻ <img>
        reader.onload = function (e) {
          $('#imgEmployee').attr('src', e.target.result);
        };

        reader.readAsDataURL(imageFile);
      }
    }
  </script>
</body>

</html>